version: '3.8'

services:
  mcp-agent-proxy:
    image: mashh/mcp-agent-proxy:latest
    ports:
      - '3001:3001'
    environment:
      - MASTRA_SERVERS=http://localhost:4111
    restart: unless-stopped
    healthcheck:
      test:
        [
          'CMD',
          'node',
          '-e',
          "const http = require('http'); const port = process.env.MCP_SERVER_PORT || '3001'; const options = { hostname: 'localhost', port: port, path: '/health', timeout: 5000 }; const req = http.get(options, (res) => process.exit(res.statusCode === 200 ? 0 : 1)); req.on('error', () => process.exit(1)); req.on('timeout', () => { req.destroy(); process.exit(1); });",
        ]
      interval: 30s
      timeout: 10s
      start_period: 30s
      retries: 3
